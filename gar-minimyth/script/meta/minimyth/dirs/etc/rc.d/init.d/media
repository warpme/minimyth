#!/bin/sh
################################################################################
# media
#
# This script mounts the remote media directories.
################################################################################
. /etc/rc.d/functions

start() {
    mm_message_output info "mounting media shares ..."

    if /usr/bin/test -n "${MM_MYTHDVD_URL}"     ; then
        mm_url_mount "${MM_MYTHDVD_URL}"     "${MM_MYTHDVD_MOUNTPOINT}"
    fi
    if /usr/bin/test -n "${MM_MYTHGALLERY_URL}" ; then
        mm_url_mount "${MM_MYTHGALLERY_URL}" "${MM_MYTHGALLERY_MOUNTPOINT}"
    fi
    if /usr/bin/test -n "${MM_MYTHGAME_URL}"    ; then
        mm_url_mount "${MM_MYTHGAME_URL}"    "${MM_MYTHGAME_MOUNTPOINT}"
    fi
    if /usr/bin/test -n "${MM_MYTHMUSIC_URL}"   ; then
        mm_url_mount "${MM_MYTHMUSIC_URL}"   "${MM_MYTHMUSIC_MOUNTPOINT}"
    fi
    if /usr/bin/test -n "${MM_MYTHVIDEO_URL}"   ; then
        mm_url_mount "${MM_MYTHVIDEO_URL}"   "${MM_MYTHVIDEO_MOUNTPOINT}"
    fi

    /bin/sed -i "s%@MEDIA_FILES_ORIGIN_PATH@%${MM_MYTHVIDEO_MOUNTPOINT}%" /home/minimyth/.xine/config

    return 0
}

stop() {
    mm_message_output info "unmounting media shares ..."

    if /usr/bin/test -n "${MM_MYTHVIDEO_URL}"   && /usr/bin/test -d "${MM_MYTHVIDEO_MOUNTPOINT}"   ; then
        /bin/umount "${MM_MYTHVIDEO_MOUNTPOINT}"
    fi
    if /usr/bin/test -n "${MM_MYTHMUSIC_URL}"   && /usr/bin/test -d "${MM_MYTHMUSIC_MOUNTPOINT}"   ; then
        /bin/umount "${MM_MYTHMUSIC_MOUNTPOINT}"
    fi
    if /usr/bin/test -n "${MM_MYTHGAME_URL}"    && /usr/bin/test -d "${MM_MYTHGAME_MOUNTPOINT}"    ; then
        /bin/umount "${MM_MYTHGAME_MOUNTPOINT}"
    fi
    if /usr/bin/test -n "${MM_MYTHGALLERY_URL}" && /usr/bin/test -d "${MM_MYTHGALLERY_MOUNTPOINT}" ; then
        /bin/umount "${MM_MYTHGALLERY_MOUNTPOINT}"
    fi
    if /usr/bin/test -n "${MM_MYTHDVD_URL}"     && /usr/bin/test -d "${MM_MYTHDVD_MOUNTPOINT}"     ; then
        /bin/umount "${MM_MYTHDVD_MOUNTPOINT}"
    fi

    return 0
}

case $1 in
    start) start ;;
    stop)  stop  ;;
esac

exit 0
